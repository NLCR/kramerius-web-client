<div id="app-viewer" class="app-viewer-wrapper" (mousemove)="onMouseMove()" (click)="onMouseMove()">
  <app-viewer-controls *ngIf="bookService.pageAvailable" [class.hide-on-inactivity]="hideOnInactivity"></app-viewer-controls>

<div class="app-selection-actions" 
      [class.hide-on-inactivity]="hideOnInactivity"
      *ngIf="showPageActions()">

      <ng-container *ngIf="!tts.inProgress()">
            <!-- <mat-icon
                  [matTooltip]="'Vybrat oblast'"
                  matTooltipPosition="left"
                  (click)="enterSelectionMode()"
                  class="app-selection app-main-selection">
                  auto_awesome
            </mat-icon> -->

            <mat-icon
                  class="app-selection app-main-selection app-hide-on-hover">
                  auto_awesome
            </mat-icon>

            <mat-icon
                  [matTooltip]="'Vybrat oblast'"
                  matTooltipPosition="left"
                  (click)="enterSelectionMode()"
                  class="app-selection">
                  highlight_alt
            </mat-icon>


            <mat-icon
                  [matTooltip]="'Textový přepis strany'"
                  matTooltipPosition="left"
                  (click)="onPageOcr()"
                  class="app-selection">
                  title
            </mat-icon>

            <mat-icon
                  [matTooltip]="'Přečíst stranu'"
                  matTooltipPosition="left"
                  (click)="onStartReadingPage()"
                  *ngIf="aiActionsEnabled()"
                  class="app-selection app-type-ai">
                  record_voice_over
            </mat-icon>

            <mat-icon
                  [matTooltip]="'Přeložit stranu'"
                  matTooltipPosition="left"
                  (click)="onTranslatePage()"
                  *ngIf="aiActionsEnabled()"
                  class="app-selection app-type-ai">
                  translate
            </mat-icon>

            <mat-icon
                  [matTooltip]="'Sumarizovat stranu'"
                  matTooltipPosition="left"
                  (click)="onSummarizePage()"
                  *ngIf="aiActionsEnabled()"
                  class="app-selection app-type-ai">
                  list
            </mat-icon>
      </ng-container>

      <ng-container *ngIf="tts.inProgress()">
            <mat-icon
                  [matTooltip]="'Zastavit čtení'"
                  matTooltipPosition="left"
                  *ngIf="aiActionsEnabled()"
                  (click)="onStopReadingPage()"
                  class="app-selection app-main-selection">
                  voice_over_off
            </mat-icon>
      </ng-container>

</div>


  <span *ngIf="controlsService.leftPanelVisible && !controlsService.fullscreenEnabled()"
        class="app-handle app-left-handle valign-wrapper hide-on-small-only" 
        tabindex="0"
        (click)="controlsService.hideLeftPanel()" 
        [matTooltip]="'view_controls.tooltip_hide_left' | translate">
        <mat-icon>arrow_left</mat-icon>
  </span>

  <span *ngIf="!controlsService.leftPanelVisible && !controlsService.fullscreenEnabled()"
        class="app-handle app-left-handle valign-wrapper hide-on-small-only" 
        tabindex="0"
        (click)="controlsService.showLeftPanel()" 
        [matTooltip]="'view_controls.tooltip_show_left' | translate">
        <mat-icon>arrow_right</mat-icon>
  </span>

  <span *ngIf="controlsService.rightPanelVisible && !controlsService.fullscreenEnabled()"
        class="app-handle app-right-handle valign-wrapper hide-on-small-only" 
        tabindex="0"
        (click)="controlsService.hideRightPanel()" 
        [matTooltip]="'view_controls.tooltip_hide_right' | translate">
        <mat-icon>arrow_right</mat-icon>
  </span>

  <span *ngIf="!controlsService.rightPanelVisible && !controlsService.fullscreenEnabled()"
        class="app-handle app-right-handle valign-wrapper hide-on-small-only" 
        tabindex="0"
        (click)="controlsService.showRightPanel()" 
        [matTooltip]="'view_controls.tooltip_show_right' | translate">
        <mat-icon>arrow_left</mat-icon>
  </span>

  
  <ng-container *ngIf="bookService.isPageInaccessible()">
      <app-licence-window [licences]="bookService.licences"></app-licence-window>
  </ng-container>


  <app-alert *ngIf="bookService.isPageFailure()"
              type="danger"
              label="alert.error"
              message="alert.failed_to_load_image">
  </app-alert>

<div class="app-alert-not-found" *ngIf="bookService.noFulltextResults()">
      <div class="app-message">{{ "alert.book_no_results" | translate }}</div>    
      <button (click)="bookService.fulltextChanged('')" mat-raised-button color="primary">{{ "alert.cancel_fulltext" | translate }}</button>
</div>

  <mat-spinner *ngIf="bookService.isPageLoading() || imageLoading" 
               class="medium-centered-spinner" 
               [strokeWidth]="3"
               [diameter]="40">
  </mat-spinner>
  
  <div *ngIf="bookService.licence && licences.bar(bookService.licence)" class="app-licence-bar">
      <span class="app-info">{{ licences.label(bookService.licence) }}</span>
      <span class="app-user">
            <ng-container *ngIf="authService.isLoggedIn()"> {{ authService.getUserId() || authService.getUserName() }} | </ng-container>
            {{ today() }}
      </span>
  </div>



<!-- <div id="selectionmenu">
      <div class="app-sel-button" (click)="onShowTextSelection()">Vypsat text</div>
      <div class="app-sel-button" (click)="onShowImageCrop()">Obrázek výřezu</div>
      <div class="app-sel-button">Sdílet</div>
      <div class="app-sel-cancel" (click)="cancelSelection()">Zvřít</div>

  </div> -->


  <div id="selectionmenu">

      <mat-icon (click)="onShowTextSelection()"
            [matTooltip]="'Textový přepis'" 
            *ngIf="showSelectText()"
            matTooltipPosition="right"
            [class.app-inactive]="!selectTextEnabled()">
            title
      </mat-icon>

      <mat-icon (click)="onShowImageCrop()"
            [matTooltip]="'Obrázek'" 
            matTooltipPosition="right"
            [class.app-inactive]="!imageCropEnabled()"
            *ngIf="showImageCrop()">
            image
      </mat-icon>

      <mat-icon (click)="onShareSelection()"
            matTooltipPosition="right"
            [matTooltip]="'book_controls.tooltip_share' | translate">
            share
      </mat-icon>

      <mat-icon (click)="onReadSelection()"
            matTooltipPosition="right"
            *ngIf="aiActionsEnabled()"
            class="app-type-ai"
            [matTooltip]="'Přečti'">
            record_voice_over
      </mat-icon>

      <mat-icon (click)="onTranslateSelection()"
            matTooltipPosition="right"
            *ngIf="aiActionsEnabled()"
            class="app-type-ai"
            [matTooltip]="'Přelož'">
            translate
      </mat-icon>

      <mat-icon (click)="onSummarizeSelection()"
            matTooltipPosition="right"
            *ngIf="aiActionsEnabled()"
            class="app-type-ai"
            [matTooltip]="'Sumarizuj'">
            list
      </mat-icon>

      <mat-icon (click)="cancelSelection()"
            matTooltipPosition="right"
            class="app-type-cancel"
            [matTooltip]="'common.close' | translate">
            close
</mat-icon>

  </div>




  <!-- <div id="selectionmenu" style="display: none; position: absolute; background-color: red; border-radius: 10px; width: 10px; height: 10px;">

  </div> -->
</div>



